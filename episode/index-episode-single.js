const episodeCard = document.querySelector('.episodeBox')
function getSingleEpisodeCard(episode) { // деталка эпизода
    const box = document.querySelector('.section-first')
    box.innerHTML = `
     <div class="episode-svg"><svg width="72" height="72" viewBox="0 0 72 72" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M58.5 11.25H13.5C11.7098 11.25 9.9929 11.9612 8.72703 13.227C7.46116 14.4929 6.75 16.2098 6.75 18V49.5C6.75 51.2902 7.46116 53.0071 8.72703 54.273C9.9929 55.5388 11.7098 56.25 13.5 56.25H58.5C60.2902 56.25 62.0071 55.5388 63.273 54.273C64.5388 53.0071 65.25 51.2902 65.25 49.5V18C65.25 16.2098 64.5388 14.4929 63.273 13.227C62.0071 11.9612 60.2902 11.25 58.5 11.25ZM60.75 49.5C60.75 50.0967 60.5129 50.669 60.091 51.091C59.669 51.5129 59.0967 51.75 58.5 51.75H13.5C12.9033 51.75 12.331 51.5129 11.909 51.091C11.4871 50.669 11.25 50.0967 11.25 49.5V18C11.25 17.4033 11.4871 16.831 11.909 16.409C12.331 15.9871 12.9033 15.75 13.5 15.75H58.5C59.0967 15.75 59.669 15.9871 60.091 16.409C60.5129 16.831 60.75 17.4033 60.75 18V49.5ZM47.25 63C47.25 63.5967 47.0129 64.169 46.591 64.591C46.169 65.0129 45.5967 65.25 45 65.25H27C26.4033 65.25 25.831 65.0129 25.409 64.591C24.9871 64.169 24.75 63.5967 24.75 63C24.75 62.4033 24.9871 61.831 25.409 61.409C25.831 60.9871 26.4033 60.75 27 60.75H45C45.5967 60.75 46.169 60.9871 46.591 61.409C47.0129 61.831 47.25 62.4033 47.25 63ZM46.2487 31.8769L32.7488 22.8769C32.4098 22.6507 32.0158 22.5209 31.6089 22.5012C31.2019 22.4815 30.7972 22.5726 30.438 22.7649C30.0788 22.9572 29.7786 23.2435 29.5693 23.5931C29.3601 23.9427 29.2497 24.3426 29.25 24.75V42.75C29.2497 43.1574 29.3601 43.5573 29.5693 43.9069C29.7786 44.2565 30.0788 44.5428 30.438 44.7351C30.7972 44.9274 31.2019 45.0185 31.6089 44.9988C32.0158 44.9791 32.4098 44.8493 32.7488 44.6231L46.2487 35.6231C46.5574 35.4177 46.8105 35.1393 46.9855 34.8125C47.1606 34.4857 47.2522 34.1207 47.2522 33.75C47.2522 33.3793 47.1606 33.0143 46.9855 32.6875C46.8105 32.3607 46.5574 32.0823 46.2487 31.8769ZM33.75 38.5453V28.9688L40.9444 33.75L33.75 38.5453Z"/>
</svg></div>
    <div class="descriptionBox">
        <div class="description">
        <div class="name">${episode.name}</div>
    <div class="typeBox">
        <div class="date"><svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M26 4H23V3C23 2.73478 22.8946 2.48043 22.7071 2.29289C22.5196 2.10536 22.2652 2 22 2C21.7348 2 21.4804 2.10536 21.2929 2.29289C21.1054 2.48043 21 2.73478 21 3V4H11V3C11 2.73478 10.8946 2.48043 10.7071 2.29289C10.5196 2.10536 10.2652 2 10 2C9.73478 2 9.48043 2.10536 9.29289 2.29289C9.10536 2.48043 9 2.73478 9 3V4H6C5.46957 4 4.96086 4.21071 4.58579 4.58579C4.21071 4.96086 4 5.46957 4 6V26C4 26.5304 4.21071 27.0391 4.58579 27.4142C4.96086 27.7893 5.46957 28 6 28H26C26.5304 28 27.0391 27.7893 27.4142 27.4142C27.7893 27.0391 28 26.5304 28 26V6C28 5.46957 27.7893 4.96086 27.4142 4.58579C27.0391 4.21071 26.5304 4 26 4ZM9 6V7C9 7.26522 9.10536 7.51957 9.29289 7.70711C9.48043 7.89464 9.73478 8 10 8C10.2652 8 10.5196 7.89464 10.7071 7.70711C10.8946 7.51957 11 7.26522 11 7V6H21V7C21 7.26522 21.1054 7.51957 21.2929 7.70711C21.4804 7.89464 21.7348 8 22 8C22.2652 8 22.5196 7.89464 22.7071 7.70711C22.8946 7.51957 23 7.26522 23 7V6H26V10H6V6H9ZM26 26H6V12H26V26Z"/>
</svg>${episode.air_date}</div>
<div class="number"><svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M4 8C4 7.73478 4.10536 7.48043 4.29289 7.29289C4.48043 7.10536 4.73478 7 5 7H27C27.2652 7 27.5196 7.10536 27.7071 7.29289C27.8946 7.48043 28 7.73478 28 8C28 8.26522 27.8946 8.51957 27.7071 8.70711C27.5196 8.89464 27.2652 9 27 9H5C4.73478 9 4.48043 8.89464 4.29289 8.70711C4.10536 8.51957 4 8.26522 4 8ZM17 15H5C4.73478 15 4.48043 15.1054 4.29289 15.2929C4.10536 15.4804 4 15.7348 4 16C4 16.2652 4.10536 16.5196 4.29289 16.7071C4.48043 16.8946 4.73478 17 5 17H17C17.2652 17 17.5196 16.8946 17.7071 16.7071C17.8946 16.5196 18 16.2652 18 16C18 15.7348 17.8946 15.4804 17.7071 15.2929C17.5196 15.1054 17.2652 15 17 15ZM17 23H5C4.73478 23 4.48043 23.1054 4.29289 23.2929C4.10536 23.4804 4 23.7348 4 24C4 24.2652 4.10536 24.5196 4.29289 24.7071C4.48043 24.8946 4.73478 25 5 25H17C17.2652 25 17.5196 24.8946 17.7071 24.7071C17.8946 24.5196 18 24.2652 18 24C18 23.7348 17.8946 23.4804 17.7071 23.2929C17.5196 23.1054 17.2652 23 17 23ZM31 20C30.9999 20.1695 30.9567 20.3362 30.8745 20.4845C30.7923 20.6327 30.6738 20.7577 30.53 20.8475L22.53 25.8475C22.3787 25.9421 22.2048 25.9944 22.0264 25.9992C21.848 26.0039 21.6716 25.9607 21.5154 25.8743C21.3593 25.7878 21.2292 25.6611 21.1386 25.5074C21.0479 25.3537 21.0001 25.1785 21 25V15C21.0001 14.8215 21.0479 14.6464 21.1386 14.4926C21.2292 14.3389 21.3593 14.2122 21.5154 14.1257C21.6716 14.0393 21.848 13.9961 22.0264 14.0008C22.2048 14.0056 22.3787 14.0579 22.53 14.1525L30.53 19.1525C30.6738 19.2423 30.7923 19.3673 30.8745 19.5155C30.9567 19.6638 30.9999 19.8305 31 20ZM28.1138 20L23 16.8037V23.1963L28.1138 20Z"/>
</svg>${episode.episode}</div>
    </div>
<div class="countOfPersonages"><svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_71_5298)">
<path d="M16 3C13.4288 3 10.9154 3.76244 8.77759 5.1909C6.63975 6.61935 4.97351 8.64968 3.98957 11.0251C3.00563 13.4006 2.74819 16.0144 3.2498 18.5362C3.75141 21.0579 4.98953 23.3743 6.80762 25.1924C8.6257 27.0105 10.9421 28.2486 13.4638 28.7502C15.9856 29.2518 18.5995 28.9944 20.9749 28.0104C23.3503 27.0265 25.3807 25.3603 26.8091 23.2224C28.2376 21.0846 29 18.5712 29 16C28.9964 12.5533 27.6256 9.24882 25.1884 6.81163C22.7512 4.37445 19.4467 3.00364 16 3ZM16 27C13.8244 27 11.6977 26.3549 9.88873 25.1462C8.07979 23.9375 6.66989 22.2195 5.83733 20.2095C5.00477 18.1995 4.78693 15.9878 5.21137 13.854C5.63581 11.7202 6.68345 9.7602 8.22183 8.22183C9.76021 6.68345 11.7202 5.6358 13.854 5.21136C15.9878 4.78692 18.1995 5.00476 20.2095 5.83733C22.2195 6.66989 23.9375 8.07979 25.1462 9.88873C26.3549 11.6977 27 13.8244 27 16C26.9967 18.9164 25.8367 21.7123 23.7745 23.7745C21.7123 25.8367 18.9164 26.9967 16 27ZM13 13.5C13 13.7967 12.912 14.0867 12.7472 14.3334C12.5824 14.58 12.3481 14.7723 12.074 14.8858C11.7999 14.9994 11.4983 15.0291 11.2074 14.9712C10.9164 14.9133 10.6491 14.7704 10.4393 14.5607C10.2296 14.3509 10.0867 14.0836 10.0288 13.7926C9.97095 13.5017 10.0007 13.2001 10.1142 12.926C10.2277 12.6519 10.42 12.4176 10.6667 12.2528C10.9133 12.088 11.2033 12 11.5 12C11.8978 12 12.2794 12.158 12.5607 12.4393C12.842 12.7206 13 13.1022 13 13.5ZM22 13.5C22 13.7967 21.912 14.0867 21.7472 14.3334C21.5824 14.58 21.3481 14.7723 21.074 14.8858C20.7999 14.9994 20.4983 15.0291 20.2074 14.9712C19.9164 14.9133 19.6491 14.7704 19.4393 14.5607C19.2296 14.3509 19.0867 14.0836 19.0288 13.7926C18.971 13.5017 19.0007 13.2001 19.1142 12.926C19.2277 12.6519 19.42 12.4176 19.6667 12.2528C19.9133 12.088 20.2033 12 20.5 12C20.8978 12 21.2794 12.158 21.5607 12.4393C21.842 12.7206 22 13.1022 22 13.5Z"/>
</g>
<defs>
<clipPath id="clip0_71_5298">
<rect width="32" height="32"/>
</clipPath>
</defs>
</svg>${episode.characters.length} Personagens participaram deste episódio</div>
</div>
    `
};
function episodeCardCreator(episodes){ // меню эпизодов
    episodeCard.innerHTML="";
    episodes.forEach(episode =>{
        episodeCard.innerHTML += `
            <div class="episode-card-box" data-id="${episode.id}">
    <span class="episodeNameNumBox"><svg width="20" height="18" viewBox="0 0 20 18" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M17.25 0H2.25C1.65326 0 1.08097 0.237053 0.65901 0.65901C0.237053 1.08097 0 1.65326 0 2.25V12.75C0 13.3467 0.237053 13.919 0.65901 14.341C1.08097 14.7629 1.65326 15 2.25 15H17.25C17.8467 15 18.419 14.7629 18.841 14.341C19.2629 13.919 19.5 13.3467 19.5 12.75V2.25C19.5 1.65326 19.2629 1.08097 18.841 0.65901C18.419 0.237053 17.8467 0 17.25 0ZM18 12.75C18 12.9489 17.921 13.1397 17.7803 13.2803C17.6397 13.421 17.4489 13.5 17.25 13.5H2.25C2.05109 13.5 1.86032 13.421 1.71967 13.2803C1.57902 13.1397 1.5 12.9489 1.5 12.75V2.25C1.5 2.05109 1.57902 1.86032 1.71967 1.71967C1.86032 1.57902 2.05109 1.5 2.25 1.5H17.25C17.4489 1.5 17.6397 1.57902 17.7803 1.71967C17.921 1.86032 18 2.05109 18 2.25V12.75ZM13.5 17.25C13.5 17.4489 13.421 17.6397 13.2803 17.7803C13.1397 17.921 12.9489 18 12.75 18H6.75C6.55109 18 6.36032 17.921 6.21967 17.7803C6.07902 17.6397 6 17.4489 6 17.25C6 17.0511 6.07902 16.8603 6.21967 16.7197C6.36032 16.579 6.55109 16.5 6.75 16.5H12.75C12.9489 16.5 13.1397 16.579 13.2803 16.7197C13.421 16.8603 13.5 17.0511 13.5 17.25ZM13.1663 6.87562L8.66625 3.87562C8.55327 3.80025 8.42195 3.75696 8.28629 3.75039C8.15064 3.74382 8.01575 3.77421 7.89601 3.83831C7.77628 3.90241 7.6762 3.99782 7.60645 4.11436C7.5367 4.2309 7.49991 4.36419 7.5 4.5V10.5C7.49991 10.6358 7.5367 10.7691 7.60645 10.8856C7.6762 11.0022 7.77628 11.0976 7.89601 11.1617C8.01575 11.2258 8.15064 11.2562 8.28629 11.2496C8.42195 11.243 8.55327 11.1998 8.66625 11.1244L13.1663 8.12438C13.2691 8.05591 13.3535 7.96309 13.4118 7.85416C13.4702 7.74523 13.5007 7.62357 13.5007 7.5C13.5007 7.37643 13.4702 7.25477 13.4118 7.14584C13.3535 7.03691 13.2691 6.94409 13.1663 6.87562ZM9 9.09844V5.90625L11.3981 7.5L9 9.09844Z"/>
</svg>${episode.name} | ${episode.episode}</span>
<span class="episodeButtonsBox">
<button class="episodeSaibaMais"><svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                  <path d="M9.75 0C7.82164 0 5.93657 0.571828 4.33319 1.64317C2.72982 2.71451 1.48013 4.23726 0.742179 6.01884C0.00422452 7.80042 -0.188858 9.76082 0.187348 11.6521C0.563554 13.5434 1.49215 15.2807 2.85571 16.6443C4.21928 18.0079 5.95656 18.9365 7.84787 19.3127C9.73919 19.6889 11.6996 19.4958 13.4812 18.7578C15.2627 18.0199 16.7855 16.7702 17.8568 15.1668C18.9282 13.5634 19.5 11.6784 19.5 9.75C19.4973 7.16498 18.4692 4.68661 16.6413 2.85872C14.8134 1.03084 12.335 0.00272983 9.75 0ZM9.75 18C8.11831 18 6.52326 17.5161 5.16655 16.6096C3.80984 15.7031 2.75242 14.4146 2.128 12.9071C1.50358 11.3996 1.3402 9.74085 1.65853 8.1405C1.97685 6.54016 2.76259 5.07015 3.91637 3.91637C5.07016 2.76259 6.54017 1.97685 8.14051 1.65852C9.74085 1.34019 11.3997 1.50357 12.9071 2.12799C14.4146 2.75242 15.7031 3.80984 16.6096 5.16655C17.5161 6.52325 18 8.1183 18 9.75C17.9975 11.9373 17.1275 14.0343 15.5809 15.5809C14.0343 17.1275 11.9373 17.9975 9.75 18ZM11.25 14.25C11.25 14.4489 11.171 14.6397 11.0303 14.7803C10.8897 14.921 10.6989 15 10.5 15C10.1022 15 9.72065 14.842 9.43934 14.5607C9.15804 14.2794 9 13.8978 9 13.5V9.75C8.80109 9.75 8.61033 9.67098 8.46967 9.53033C8.32902 9.38968 8.25 9.19891 8.25 9C8.25 8.80109 8.32902 8.61032 8.46967 8.46967C8.61033 8.32902 8.80109 8.25 9 8.25C9.39783 8.25 9.77936 8.40804 10.0607 8.68934C10.342 8.97064 10.5 9.35218 10.5 9.75V13.5C10.6989 13.5 10.8897 13.579 11.0303 13.7197C11.171 13.8603 11.25 14.0511 11.25 14.25ZM8.25 5.625C8.25 5.4025 8.31598 5.18499 8.4396 4.99998C8.56322 4.81498 8.73892 4.67078 8.94449 4.58564C9.15005 4.50049 9.37625 4.47821 9.59448 4.52162C9.81271 4.56502 10.0132 4.67217 10.1705 4.8295C10.3278 4.98684 10.435 5.18729 10.4784 5.40552C10.5218 5.62375 10.4995 5.84995 10.4144 6.05552C10.3292 6.26109 10.185 6.43679 10 6.5604C9.81501 6.68402 9.59751 6.75 9.375 6.75C9.07664 6.75 8.79049 6.63147 8.57951 6.4205C8.36853 6.20952 8.25 5.92337 8.25 5.625Z"/>
                                  </svg>Saiba mais</button></span>
            </div> 
        `
    });
};
async function getEpisodeAPI(page){
 const response = await fetch(`https://rickandmortyapi.com/api/episode?page=${page}`);
 const episodesList = await response.json();
 episodeCardCreator(episodesList.results);
 getPaginationEpisode(episodesList.info.pages);
};
async function getSingleEpisode(id) {
    const response = await fetch (`https://rickandmortyapi.com/api/episode/${id}`);
    const singleEpisode = await response.json();
    getSingleEpisodeCard(singleEpisode);
};
function getPaginationEpisode(pages){
    document.querySelector('.paginationEpisode').innerHTML = "";
    for(let i = 1; i <= pages;i++){
    document.querySelector('.paginationEpisode').innerHTML += `<button class="paginationButtonEpisode">${i}</button>`
    };
};
function onClickPaginationButtonEpisode() {
    const paginationEpisode = document.querySelector('.paginationEpisode');

    paginationEpisode.addEventListener('click', function(event){
        const buttonOfPaginationEpisode = event.target.closest('.paginationButtonEpisode');
        if (!buttonOfPaginationEpisode) return;
        document.querySelectorAll('.paginationButtonEpisode')
            .forEach(btn => btn.classList.remove('active'));
        buttonOfPaginationEpisode.classList.add('active');

        getEpisodeAPI(buttonOfPaginationEpisode.innerText);
    });
};
const params = new URLSearchParams (window.location.search);
const id = params.get('id');
if(id){
    getSingleEpisode(id)
}

getEpisodeAPI(1);
onClickPaginationButtonEpisode();
iconButton();

    episodeCard.addEventListener('click', function (event) {
        const button = event.target.closest('.episodeSaibaMais');
        if (!button) return;

        const card = button.closest('.episode-card-box');
        const id = card.dataset.id;
        window.location.href = `../episode/index-episode-single.html?id=${id}`;
    });

    function iconButton(){
    const button = document.querySelector('.header-svg');
    button.addEventListener('click', function(){
        window.location.href = `../first%20page/index.html`
    })
}